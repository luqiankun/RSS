## 调度器主循环

- 从命令池取当前索引车辆的命令栈顶命令
- 处理一次,如果状态是DISPOSABLE，清除命令
- 索引+1
- 如果某个车辆命令池空了，清除该车辆对应的list项，防止内存溢出

## 命令处理

命令由车辆创建，调度器通过命令来控制车辆移动等，执行完一个命令后，车辆会自动生成下个命令，或IDLE

获取当前命令的状态处理一次

### 命令状态对应的处理内容

- INIT
  状态--->正在分配状态
- ALLOCATING
  - 检查阻挡冲突交换冲突
  - 有阻挡冲突，重新分配订单，车辆会将命令的状态切换到重新分配状态
  - 无冲突
    - 获取要锁定的资源
    - 锁定成功 ，状态--->已分配状态
    - 锁定失败，返回，下次继续尝试分配
- ALLOCATED
  - 判断当前运输订单状态
    - TRAVELLING
      - 获取当前step
        - step 为空，运输订单状态变为OPERATING
        - step 不为空，执行车辆move回调
    - OPERATING
      - 执行车辆action回调
      - 状态--->执行状态
- EXECUTING
  - 等待车辆执行完
    - 车辆执行完会执行vehicle_execute_cb回调
  - vehicle_execute_cb内容
    - 订单失败或车辆已经释放  状态--->可清理
    - 状态--->执行结束
- EXECUTED
  - 状态--->可清理
  - 获取下次要分配的资源 ，状态--->结束
- END
  - 状态--->可清理
  - 通知车辆命令执行结束
- REDISBUTE
  - 重新分配订单
  - 状态--->可清理
